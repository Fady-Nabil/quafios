GAS LISTING /tmp/ccS10dth.s 			page 1


   1              		.file	"main.c"
   2              		.comm	timer_fd,4,4
   3              		.globl	scheduled
   4              		.data
   5              		.align 4
   6              		.type	scheduled, @object
   7              		.size	scheduled, 4
   8              	scheduled:
   9 0000 00000000 		.zero	4
  10              		.comm	pstty_fd,4,4
  11              		.globl	pstty_file
  12              		.align 4
  13              		.type	pstty_file, @object
  14              		.size	pstty_file, 20
  15              	pstty_file:
  16 0004 2F646576 		.string	"/dev/pstty"
  16      2F707374 
  16      747900
  17 000f 00000000 		.zero	9
  17      00000000 
  17      00
  18              		.comm	win,4,4
  19              		.local	font
  20              		.comm	font,4096,32
  21              		.comm	font_width,4,4
  22              		.comm	font_height,4,4
  23              		.globl	x1
  24              		.align 4
  25              		.type	x1, @object
  26              		.size	x1, 4
  27              	x1:
  28 0018 FFFFFFFF 		.long	-1
  29              		.globl	y1
  30              		.align 4
  31              		.type	y1, @object
  32              		.size	y1, 4
  33              	y1:
  34 001c FFFFFFFF 		.long	-1
  35              		.globl	x2
  36              		.align 4
  37              		.type	x2, @object
  38              		.size	x2, 4
  39              	x2:
  40 0020 FFFFFFFF 		.long	-1
  41              		.globl	y2
  42              		.align 4
  43              		.type	y2, @object
  44              		.size	y2, 4
  45              	y2:
  46 0024 FFFFFFFF 		.long	-1
  47              		.section	.rodata
  48              	.LC0:
  49 0000 7200     		.string	"r"
  50              	.LC1:
  51 0002 2F757372 		.string	"/usr/share/fonts/font6x12.fon"
  51      2F736861 
  51      72652F66 
GAS LISTING /tmp/ccS10dth.s 			page 2


  51      6F6E7473 
  51      2F666F6E 
  52              	.LC2:
  53 0020 256300   		.string	"%c"
  54              		.section	.text.font_init,"ax",@progbits
  55              		.globl	font_init
  56              		.type	font_init, @function
  57              	font_init:
  58              	.LFB1:
  59              		.cfi_startproc
  60 0000 55       		pushl	%ebp
  61              		.cfi_def_cfa_offset 8
  62              		.cfi_offset 5, -8
  63 0001 89E5     		movl	%esp, %ebp
  64              		.cfi_def_cfa_register 5
  65 0003 83EC18   		subl	$24, %esp
  66 0006 83EC08   		subl	$8, %esp
  67 0009 68000000 		pushl	$.LC0
  67      00
  68 000e 68020000 		pushl	$.LC1
  68      00
  69 0013 E8FCFFFF 		call	fopen
  69      FF
  70 0018 83C410   		addl	$16, %esp
  71 001b 8945EC   		movl	%eax, -20(%ebp)
  72 001e C7050000 		movl	$6, font_width
  72      00000600 
  72      0000
  73 0028 C7050000 		movl	$12, font_height
  73      00000C00 
  73      0000
  74 0032 C745F400 		movl	$0, -12(%ebp)
  74      000000
  75 0039 EB43     		jmp	.L2
  76              	.L5:
  77 003b C745F000 		movl	$0, -16(%ebp)
  77      000000
  78 0042 EB2A     		jmp	.L3
  79              	.L4:
  80 0044 8B45F4   		movl	-12(%ebp), %eax
  81 0047 C1E004   		sall	$4, %eax
  82 004a 89C2     		movl	%eax, %edx
  83 004c 8B45F0   		movl	-16(%ebp), %eax
  84 004f 01D0     		addl	%edx, %eax
  85 0051 05000000 		addl	$font, %eax
  85      00
  86 0056 83EC04   		subl	$4, %esp
  87 0059 50       		pushl	%eax
  88 005a 68200000 		pushl	$.LC2
  88      00
  89 005f FF75EC   		pushl	-20(%ebp)
  90 0062 E8FCFFFF 		call	fscanf
  90      FF
  91 0067 83C410   		addl	$16, %esp
  92 006a 8345F001 		addl	$1, -16(%ebp)
  93              	.L3:
  94 006e 8B55F0   		movl	-16(%ebp), %edx
GAS LISTING /tmp/ccS10dth.s 			page 3


  95 0071 A1000000 		movl	font_height, %eax
  95      00
  96 0076 39C2     		cmpl	%eax, %edx
  97 0078 72CA     		jb	.L4
  98 007a 8345F401 		addl	$1, -12(%ebp)
  99              	.L2:
 100 007e 817DF4FF 		cmpl	$255, -12(%ebp)
 100      000000
 101 0085 7EB4     		jle	.L5
 102 0087 83EC0C   		subl	$12, %esp
 103 008a FF75EC   		pushl	-20(%ebp)
 104 008d E8FCFFFF 		call	fclose
 104      FF
 105 0092 83C410   		addl	$16, %esp
 106 0095 90       		nop
 107 0096 C9       		leave
 108              		.cfi_restore 5
 109              		.cfi_def_cfa 4, 4
 110 0097 C3       		ret
 111              		.cfi_endproc
 112              	.LFE1:
 113              		.size	font_init, .-font_init
 114              		.section	.rodata
 115              	.LC3:
 116 0023 2F646576 		.string	"/dev/console"
 116      2F636F6E 
 116      736F6C65 
 116      00
 117              		.section	.text.pstty_init,"ax",@progbits
 118              		.globl	pstty_init
 119              		.type	pstty_init, @function
 120              	pstty_init:
 121              	.LFB2:
 122              		.cfi_startproc
 123 0000 55       		pushl	%ebp
 124              		.cfi_def_cfa_offset 8
 125              		.cfi_offset 5, -8
 126 0001 89E5     		movl	%esp, %ebp
 127              		.cfi_def_cfa_register 5
 128 0003 53       		pushl	%ebx
 129 0004 83EC14   		subl	$20, %esp
 130              		.cfi_offset 3, -12
 131 0007 C745EC00 		movl	$0, -20(%ebp)
 131      000000
 132 000e C745F000 		movl	$0, -16(%ebp)
 132      000000
 133 0015 83EC08   		subl	$8, %esp
 134 0018 6A00     		pushl	$0
 135 001a 68230000 		pushl	$.LC3
 135      00
 136 001f E8FCFFFF 		call	open
 136      FF
 137 0024 83C410   		addl	$16, %esp
 138 0027 8945F4   		movl	%eax, -12(%ebp)
 139 002a C645EC10 		movb	$16, -20(%ebp)
 140 002e 83EC04   		subl	$4, %esp
 141 0031 8D45EC   		leal	-20(%ebp), %eax
GAS LISTING /tmp/ccS10dth.s 			page 4


 142 0034 50       		pushl	%eax
 143 0035 6A0D     		pushl	$13
 144 0037 FF75F4   		pushl	-12(%ebp)
 145 003a E8FCFFFF 		call	ioctl
 145      FF
 146 003f 83C410   		addl	$16, %esp
 147 0042 83EC0C   		subl	$12, %esp
 148 0045 FF75F4   		pushl	-12(%ebp)
 149 0048 E8FCFFFF 		call	close
 149      FF
 150 004d 83C410   		addl	$16, %esp
 151 0050 83EC0C   		subl	$12, %esp
 152 0053 68000000 		pushl	$pstty_file
 152      00
 153 0058 E8FCFFFF 		call	strlen
 153      FF
 154 005d 83C410   		addl	$16, %esp
 155 0060 8D980000 		leal	pstty_file(%eax), %ebx
 155      0000
 156 0066 E8FCFFFF 		call	getpid
 156      FF
 157 006b 83EC04   		subl	$4, %esp
 158 006e 6A0A     		pushl	$10
 159 0070 53       		pushl	%ebx
 160 0071 50       		pushl	%eax
 161 0072 E8FCFFFF 		call	itoa
 161      FF
 162 0077 83C410   		addl	$16, %esp
 163 007a 8B45F0   		movl	-16(%ebp), %eax
 164 007d 83EC04   		subl	$4, %esp
 165 0080 50       		pushl	%eax
 166 0081 68772700 		pushl	$10103
 166      00
 167 0086 68000000 		pushl	$pstty_file
 167      00
 168 008b E8FCFFFF 		call	mknod
 168      FF
 169 0090 83C410   		addl	$16, %esp
 170 0093 83EC08   		subl	$8, %esp
 171 0096 6A00     		pushl	$0
 172 0098 68000000 		pushl	$pstty_file
 172      00
 173 009d E8FCFFFF 		call	open
 173      FF
 174 00a2 83C410   		addl	$16, %esp
 175 00a5 A3000000 		movl	%eax, pstty_fd
 175      00
 176 00aa 90       		nop
 177 00ab 8B5DFC   		movl	-4(%ebp), %ebx
 178 00ae C9       		leave
 179              		.cfi_restore 5
 180              		.cfi_restore 3
 181              		.cfi_def_cfa 4, 4
 182 00af C3       		ret
 183              		.cfi_endproc
 184              	.LFE2:
 185              		.size	pstty_init, .-pstty_init
GAS LISTING /tmp/ccS10dth.s 			page 5


 186              		.section	.rodata
 187              	.LC4:
 188 0030 2F646576 		.string	"/dev/timer"
 188      2F74696D 
 188      657200
 189              		.section	.text.timer_init,"ax",@progbits
 190              		.globl	timer_init
 191              		.type	timer_init, @function
 192              	timer_init:
 193              	.LFB3:
 194              		.cfi_startproc
 195 0000 55       		pushl	%ebp
 196              		.cfi_def_cfa_offset 8
 197              		.cfi_offset 5, -8
 198 0001 89E5     		movl	%esp, %ebp
 199              		.cfi_def_cfa_register 5
 200 0003 83EC08   		subl	$8, %esp
 201 0006 83EC08   		subl	$8, %esp
 202 0009 6A00     		pushl	$0
 203 000b 68300000 		pushl	$.LC4
 203      00
 204 0010 E8FCFFFF 		call	open
 204      FF
 205 0015 83C410   		addl	$16, %esp
 206 0018 A3000000 		movl	%eax, timer_fd
 206      00
 207 001d 90       		nop
 208 001e C9       		leave
 209              		.cfi_restore 5
 210              		.cfi_def_cfa 4, 4
 211 001f C3       		ret
 212              		.cfi_endproc
 213              	.LFE3:
 214              		.size	timer_init, .-timer_init
 215              		.section	.rodata
 216              	.LC5:
 217 003b 2F686F6D 		.string	"/home"
 217      6500
 218              		.section	.text.exec_shell,"ax",@progbits
 219              		.globl	exec_shell
 220              		.type	exec_shell, @function
 221              	exec_shell:
 222              	.LFB4:
 223              		.cfi_startproc
 224 0000 55       		pushl	%ebp
 225              		.cfi_def_cfa_offset 8
 226              		.cfi_offset 5, -8
 227 0001 89E5     		movl	%esp, %ebp
 228              		.cfi_def_cfa_register 5
 229 0003 83EC08   		subl	$8, %esp
 230 0006 E8FCFFFF 		call	fork
 230      FF
 231 000b 85C0     		testl	%eax, %eax
 232 000d 757F     		jne	.L10
 233 000f 83EC0C   		subl	$12, %esp
 234 0012 6A00     		pushl	$0
 235 0014 E8FCFFFF 		call	close
GAS LISTING /tmp/ccS10dth.s 			page 6


 235      FF
 236 0019 83C410   		addl	$16, %esp
 237 001c 83EC0C   		subl	$12, %esp
 238 001f 6A01     		pushl	$1
 239 0021 E8FCFFFF 		call	close
 239      FF
 240 0026 83C410   		addl	$16, %esp
 241 0029 83EC0C   		subl	$12, %esp
 242 002c 6A02     		pushl	$2
 243 002e E8FCFFFF 		call	close
 243      FF
 244 0033 83C410   		addl	$16, %esp
 245 0036 83EC0C   		subl	$12, %esp
 246 0039 683B0000 		pushl	$.LC5
 246      00
 247 003e E8FCFFFF 		call	chdir
 247      FF
 248 0043 83C410   		addl	$16, %esp
 249 0046 83EC08   		subl	$8, %esp
 250 0049 6A00     		pushl	$0
 251 004b 68000000 		pushl	$pstty_file
 251      00
 252 0050 E8FCFFFF 		call	open
 252      FF
 253 0055 83C410   		addl	$16, %esp
 254 0058 83EC08   		subl	$8, %esp
 255 005b 6A00     		pushl	$0
 256 005d 68000000 		pushl	$pstty_file
 256      00
 257 0062 E8FCFFFF 		call	open
 257      FF
 258 0067 83C410   		addl	$16, %esp
 259 006a 83EC08   		subl	$8, %esp
 260 006d 6A00     		pushl	$0
 261 006f 68000000 		pushl	$pstty_file
 261      00
 262 0074 E8FCFFFF 		call	open
 262      FF
 263 0079 83C410   		addl	$16, %esp
 264 007c 83EC04   		subl	$4, %esp
 265 007f 6A00     		pushl	$0
 266 0081 6A00     		pushl	$0
 267 0083 FF7508   		pushl	8(%ebp)
 268 0086 E8FCFFFF 		call	execve
 268      FF
 269 008b 83C410   		addl	$16, %esp
 270              	.L10:
 271 008e 90       		nop
 272 008f C9       		leave
 273              		.cfi_restore 5
 274              		.cfi_def_cfa 4, 4
 275 0090 C3       		ret
 276              		.cfi_endproc
 277              	.LFE4:
 278              		.size	exec_shell, .-exec_shell
 279              		.globl	buf
 280              		.data
GAS LISTING /tmp/ccS10dth.s 			page 7


 281 0028 00000000 		.align 32
 281      00000000 
 281      00000000 
 281      00000000 
 281      00000000 
 282              		.type	buf, @object
 283              		.size	buf, 4000
 284              	buf:
 285 0040 00000000 		.zero	4000
 285      00000000 
 285      00000000 
 285      00000000 
 285      00000000 
 286              		.align 4
 287              		.type	vga_row, @object
 288              		.size	vga_row, 4
 289              	vga_row:
 290 0fe0 00000000 		.zero	4
 291              		.align 4
 292              		.type	vga_col, @object
 293              		.size	vga_col, 4
 294              	vga_col:
 295 0fe4 00000000 		.zero	4
 296              		.align 4
 297              		.type	vga_attrib, @object
 298              		.size	vga_attrib, 4
 299              	vga_attrib:
 300 0fe8 0F000000 		.long	15
 301 0fec 00000000 		.align 32
 301      00000000 
 301      00000000 
 301      00000000 
 301      00000000 
 302              		.type	color_palette, @object
 303              		.size	color_palette, 64
 304              	color_palette:
 305 1000 000000FF 		.long	-16777216
 306 1004 AA0000FF 		.long	-16777046
 307 1008 00AA00FF 		.long	-16733696
 308 100c AAAA00FF 		.long	-16733526
 309 1010 0000AAFF 		.long	-5636096
 310 1014 AA00AAFF 		.long	-5635926
 311 1018 0055AAFF 		.long	-5614336
 312 101c AAAAAAFF 		.long	-5592406
 313 1020 555555FF 		.long	-11184811
 314 1024 FF5555FF 		.long	-11184641
 315 1028 55FF55FF 		.long	-11141291
 316 102c FFFF55FF 		.long	-11141121
 317 1030 5555FFFF 		.long	-43691
 318 1034 FF55FFFF 		.long	-43521
 319 1038 55FFFFFF 		.long	-171
 320 103c FFFFFFFF 		.long	-1
 321              		.section	.text.draw_char,"ax",@progbits
 322              		.globl	draw_char
 323              		.type	draw_char, @function
 324              	draw_char:
 325              	.LFB5:
GAS LISTING /tmp/ccS10dth.s 			page 8


 326              		.cfi_startproc
 327 0000 55       		pushl	%ebp
 328              		.cfi_def_cfa_offset 8
 329              		.cfi_offset 5, -8
 330 0001 89E5     		movl	%esp, %ebp
 331              		.cfi_def_cfa_register 5
 332 0003 83EC48   		subl	$72, %esp
 333 0006 8B5508   		movl	8(%ebp), %edx
 334 0009 8B450C   		movl	12(%ebp), %eax
 335 000c 8855C4   		movb	%dl, -60(%ebp)
 336 000f 8845C0   		movb	%al, -64(%ebp)
 337 0012 8B150000 		movl	font_width, %edx
 337      0000
 338 0018 8B4510   		movl	16(%ebp), %eax
 339 001b 0FAFC2   		imull	%edx, %eax
 340 001e 8945EC   		movl	%eax, -20(%ebp)
 341 0021 8B150000 		movl	font_height, %edx
 341      0000
 342 0027 8B4514   		movl	20(%ebp), %eax
 343 002a 0FAFC2   		imull	%edx, %eax
 344 002d 8945E8   		movl	%eax, -24(%ebp)
 345 0030 0FB645C0 		movzbl	-64(%ebp), %eax
 346 0034 C0F804   		sarb	$4, %al
 347 0037 0FBEC0   		movsbl	%al, %eax
 348 003a 83E00F   		andl	$15, %eax
 349 003d 8B048500 		movl	color_palette(,%eax,4), %eax
 349      100000
 350 0044 8945E4   		movl	%eax, -28(%ebp)
 351 0047 0FBE45C0 		movsbl	-64(%ebp), %eax
 352 004b 83E00F   		andl	$15, %eax
 353 004e 8B048500 		movl	color_palette(,%eax,4), %eax
 353      100000
 354 0055 8945E0   		movl	%eax, -32(%ebp)
 355 0058 8B5514   		movl	20(%ebp), %edx
 356 005b 89D0     		movl	%edx, %eax
 357 005d C1E002   		sall	$2, %eax
 358 0060 01D0     		addl	%edx, %eax
 359 0062 C1E004   		sall	$4, %eax
 360 0065 89C2     		movl	%eax, %edx
 361 0067 8B4510   		movl	16(%ebp), %eax
 362 006a 01D0     		addl	%edx, %eax
 363 006c 8D1400   		leal	(%eax,%eax), %edx
 364 006f 0FB645C4 		movzbl	-60(%ebp), %eax
 365 0073 88820000 		movb	%al, buf(%edx)
 365      0000
 366 0079 8B5514   		movl	20(%ebp), %edx
 367 007c 89D0     		movl	%edx, %eax
 368 007e C1E002   		sall	$2, %eax
 369 0081 01D0     		addl	%edx, %eax
 370 0083 C1E004   		sall	$4, %eax
 371 0086 89C2     		movl	%eax, %edx
 372 0088 8B4510   		movl	16(%ebp), %eax
 373 008b 01D0     		addl	%edx, %eax
 374 008d 01C0     		addl	%eax, %eax
 375 008f 8D5001   		leal	1(%eax), %edx
 376 0092 0FB645C0 		movzbl	-64(%ebp), %eax
 377 0096 88820000 		movb	%al, buf(%edx)
GAS LISTING /tmp/ccS10dth.s 			page 9


 377      0000
 378 009c C745F400 		movl	$0, -12(%ebp)
 378      000000
 379 00a3 E9A80000 		jmp	.L12
 379      00
 380              	.L17:
 381 00a8 C745F000 		movl	$0, -16(%ebp)
 381      000000
 382 00af E9880000 		jmp	.L13
 382      00
 383              	.L16:
 384 00b4 0FBE45C4 		movsbl	-60(%ebp), %eax
 385 00b8 C1E004   		sall	$4, %eax
 386 00bb 89C2     		movl	%eax, %edx
 387 00bd 8B45F0   		movl	-16(%ebp), %eax
 388 00c0 01D0     		addl	%edx, %eax
 389 00c2 05000000 		addl	$font, %eax
 389      00
 390 00c7 0FB600   		movzbl	(%eax), %eax
 391 00ca 0FB6D0   		movzbl	%al, %edx
 392 00cd B8070000 		movl	$7, %eax
 392      00
 393 00d2 2B45F4   		subl	-12(%ebp), %eax
 394 00d5 89C1     		movl	%eax, %ecx
 395 00d7 D3FA     		sarl	%cl, %edx
 396 00d9 89D0     		movl	%edx, %eax
 397 00db 83E001   		andl	$1, %eax
 398 00de 85C0     		testl	%eax, %eax
 399 00e0 742C     		je	.L14
 400 00e2 8B55F0   		movl	-16(%ebp), %edx
 401 00e5 8B45E8   		movl	-24(%ebp), %eax
 402 00e8 8D0C02   		leal	(%edx,%eax), %ecx
 403 00eb 8B55F4   		movl	-12(%ebp), %edx
 404 00ee 8B45EC   		movl	-20(%ebp), %eax
 405 00f1 01C2     		addl	%eax, %edx
 406 00f3 A1000000 		movl	win, %eax
 406      00
 407 00f8 8B80D800 		movl	216(%eax), %eax
 407      0000
 408 00fe FF75E0   		pushl	-32(%ebp)
 409 0101 51       		pushl	%ecx
 410 0102 52       		pushl	%edx
 411 0103 50       		pushl	%eax
 412 0104 E8FCFFFF 		call	pixbuf_set_pixel
 412      FF
 413 0109 83C410   		addl	$16, %esp
 414 010c EB2A     		jmp	.L15
 415              	.L14:
 416 010e 8B55F0   		movl	-16(%ebp), %edx
 417 0111 8B45E8   		movl	-24(%ebp), %eax
 418 0114 8D0C02   		leal	(%edx,%eax), %ecx
 419 0117 8B55F4   		movl	-12(%ebp), %edx
 420 011a 8B45EC   		movl	-20(%ebp), %eax
 421 011d 01C2     		addl	%eax, %edx
 422 011f A1000000 		movl	win, %eax
 422      00
 423 0124 8B80D800 		movl	216(%eax), %eax
GAS LISTING /tmp/ccS10dth.s 			page 10


 423      0000
 424 012a FF75E4   		pushl	-28(%ebp)
 425 012d 51       		pushl	%ecx
 426 012e 52       		pushl	%edx
 427 012f 50       		pushl	%eax
 428 0130 E8FCFFFF 		call	pixbuf_set_pixel
 428      FF
 429 0135 83C410   		addl	$16, %esp
 430              	.L15:
 431 0138 8345F001 		addl	$1, -16(%ebp)
 432              	.L13:
 433 013c 8B55F0   		movl	-16(%ebp), %edx
 434 013f A1000000 		movl	font_height, %eax
 434      00
 435 0144 39C2     		cmpl	%eax, %edx
 436 0146 0F8268FF 		jb	.L16
 436      FFFF
 437 014c 8345F401 		addl	$1, -12(%ebp)
 438              	.L12:
 439 0150 8B55F4   		movl	-12(%ebp), %edx
 440 0153 A1000000 		movl	font_width, %eax
 440      00
 441 0158 39C2     		cmpl	%eax, %edx
 442 015a 0F8248FF 		jb	.L17
 442      FFFF
 443 0160 A1000000 		movl	x1, %eax
 443      00
 444 0165 83F8FF   		cmpl	$-1, %eax
 445 0168 7532     		jne	.L18
 446 016a 8B45EC   		movl	-20(%ebp), %eax
 447 016d A3000000 		movl	%eax, x1
 447      00
 448 0172 8B45E8   		movl	-24(%ebp), %eax
 449 0175 A3000000 		movl	%eax, y1
 449      00
 450 017a 8B150000 		movl	font_width, %edx
 450      0000
 451 0180 8B45EC   		movl	-20(%ebp), %eax
 452 0183 01D0     		addl	%edx, %eax
 453 0185 A3000000 		movl	%eax, x2
 453      00
 454 018a 8B150000 		movl	font_height, %edx
 454      0000
 455 0190 8B45E8   		movl	-24(%ebp), %eax
 456 0193 01D0     		addl	%edx, %eax
 457 0195 A3000000 		movl	%eax, y2
 457      00
 458 019a EB6C     		jmp	.L19
 459              	.L18:
 460 019c A1000000 		movl	x1, %eax
 460      00
 461 01a1 3945EC   		cmpl	%eax, -20(%ebp)
 462 01a4 7308     		jnb	.L20
 463 01a6 8B45EC   		movl	-20(%ebp), %eax
 464 01a9 A3000000 		movl	%eax, x1
 464      00
 465              	.L20:
GAS LISTING /tmp/ccS10dth.s 			page 11


 466 01ae A1000000 		movl	y1, %eax
 466      00
 467 01b3 3945E8   		cmpl	%eax, -24(%ebp)
 468 01b6 7308     		jnb	.L21
 469 01b8 8B45E8   		movl	-24(%ebp), %eax
 470 01bb A3000000 		movl	%eax, y1
 470      00
 471              	.L21:
 472 01c0 8B150000 		movl	font_width, %edx
 472      0000
 473 01c6 8B45EC   		movl	-20(%ebp), %eax
 474 01c9 01C2     		addl	%eax, %edx
 475 01cb A1000000 		movl	x2, %eax
 475      00
 476 01d0 39C2     		cmpl	%eax, %edx
 477 01d2 7610     		jbe	.L22
 478 01d4 8B150000 		movl	font_width, %edx
 478      0000
 479 01da 8B45EC   		movl	-20(%ebp), %eax
 480 01dd 01D0     		addl	%edx, %eax
 481 01df A3000000 		movl	%eax, x2
 481      00
 482              	.L22:
 483 01e4 8B150000 		movl	font_height, %edx
 483      0000
 484 01ea 8B45E8   		movl	-24(%ebp), %eax
 485 01ed 01C2     		addl	%eax, %edx
 486 01ef A1000000 		movl	y2, %eax
 486      00
 487 01f4 39C2     		cmpl	%eax, %edx
 488 01f6 7610     		jbe	.L19
 489 01f8 8B150000 		movl	font_height, %edx
 489      0000
 490 01fe 8B45E8   		movl	-24(%ebp), %eax
 491 0201 01D0     		addl	%edx, %eax
 492 0203 A3000000 		movl	%eax, y2
 492      00
 493              	.L19:
 494 0208 A1000000 		movl	scheduled, %eax
 494      00
 495 020d 85C0     		testl	%eax, %eax
 496 020f 752C     		jne	.L24
 497 0211 C645D411 		movb	$17, -44(%ebp)
 498 0215 C745D80A 		movl	$10, -40(%ebp)
 498      000000
 499 021c A1000000 		movl	timer_fd, %eax
 499      00
 500 0221 83EC04   		subl	$4, %esp
 501 0224 8D55D4   		leal	-44(%ebp), %edx
 502 0227 52       		pushl	%edx
 503 0228 6A00     		pushl	$0
 504 022a 50       		pushl	%eax
 505 022b E8FCFFFF 		call	ioctl
 505      FF
 506 0230 83C410   		addl	$16, %esp
 507 0233 C7050000 		movl	$1, scheduled
 507      00000100 
GAS LISTING /tmp/ccS10dth.s 			page 12


 507      0000
 508              	.L24:
 509 023d 90       		nop
 510 023e C9       		leave
 511              		.cfi_restore 5
 512              		.cfi_def_cfa 4, 4
 513 023f C3       		ret
 514              		.cfi_endproc
 515              	.LFE5:
 516              		.size	draw_char, .-draw_char
 517              		.section	.text.scroll,"ax",@progbits
 518              		.globl	scroll
 519              		.type	scroll, @function
 520              	scroll:
 521              	.LFB6:
 522              		.cfi_startproc
 523 0000 55       		pushl	%ebp
 524              		.cfi_def_cfa_offset 8
 525              		.cfi_offset 5, -8
 526 0001 89E5     		movl	%esp, %ebp
 527              		.cfi_def_cfa_register 5
 528 0003 56       		pushl	%esi
 529 0004 53       		pushl	%ebx
 530 0005 83EC10   		subl	$16, %esp
 531              		.cfi_offset 6, -12
 532              		.cfi_offset 3, -16
 533 0008 C745F400 		movl	$0, -12(%ebp)
 533      000000
 534 000f EB1E     		jmp	.L26
 535              	.L27:
 536 0011 8B45F4   		movl	-12(%ebp), %eax
 537 0014 05A00000 		addl	$160, %eax
 537      00
 538 0019 0FB68000 		movzbl	buf(%eax), %eax
 538      000000
 539 0020 8B55F4   		movl	-12(%ebp), %edx
 540 0023 81C20000 		addl	$buf, %edx
 540      0000
 541 0029 8802     		movb	%al, (%edx)
 542 002b 8345F401 		addl	$1, -12(%ebp)
 543              	.L26:
 544 002f 817DF4FF 		cmpl	$3839, -12(%ebp)
 544      0E0000
 545 0036 76D9     		jbe	.L27
 546 0038 EB0F     		jmp	.L28
 547              	.L29:
 548 003a 8B45F4   		movl	-12(%ebp), %eax
 549 003d 05000000 		addl	$buf, %eax
 549      00
 550 0042 C60020   		movb	$32, (%eax)
 551 0045 8345F402 		addl	$2, -12(%ebp)
 552              	.L28:
 553 0049 817DF49F 		cmpl	$3999, -12(%ebp)
 553      0F0000
 554 0050 76E8     		jbe	.L29
 555 0052 C745F400 		movl	$0, -12(%ebp)
 555      000000
GAS LISTING /tmp/ccS10dth.s 			page 13


 556 0059 EB6C     		jmp	.L30
 557              	.L33:
 558 005b C745F000 		movl	$0, -16(%ebp)
 558      000000
 559 0062 EB59     		jmp	.L31
 560              	.L32:
 561 0064 8B75F4   		movl	-12(%ebp), %esi
 562 0067 8B5DF0   		movl	-16(%ebp), %ebx
 563 006a 8B55F4   		movl	-12(%ebp), %edx
 564 006d 89D0     		movl	%edx, %eax
 565 006f C1E002   		sall	$2, %eax
 566 0072 01D0     		addl	%edx, %eax
 567 0074 C1E004   		sall	$4, %eax
 568 0077 89C2     		movl	%eax, %edx
 569 0079 8B45F0   		movl	-16(%ebp), %eax
 570 007c 01D0     		addl	%edx, %eax
 571 007e 01C0     		addl	%eax, %eax
 572 0080 83C001   		addl	$1, %eax
 573 0083 0FB68000 		movzbl	buf(%eax), %eax
 573      000000
 574 008a 0FBEC8   		movsbl	%al, %ecx
 575 008d 8B55F4   		movl	-12(%ebp), %edx
 576 0090 89D0     		movl	%edx, %eax
 577 0092 C1E002   		sall	$2, %eax
 578 0095 01D0     		addl	%edx, %eax
 579 0097 C1E004   		sall	$4, %eax
 580 009a 89C2     		movl	%eax, %edx
 581 009c 8B45F0   		movl	-16(%ebp), %eax
 582 009f 01D0     		addl	%edx, %eax
 583 00a1 01C0     		addl	%eax, %eax
 584 00a3 0FB68000 		movzbl	buf(%eax), %eax
 584      000000
 585 00aa 0FBEC0   		movsbl	%al, %eax
 586 00ad 56       		pushl	%esi
 587 00ae 53       		pushl	%ebx
 588 00af 51       		pushl	%ecx
 589 00b0 50       		pushl	%eax
 590 00b1 E8FCFFFF 		call	draw_char
 590      FF
 591 00b6 83C410   		addl	$16, %esp
 592 00b9 8345F001 		addl	$1, -16(%ebp)
 593              	.L31:
 594 00bd 837DF04F 		cmpl	$79, -16(%ebp)
 595 00c1 76A1     		jbe	.L32
 596 00c3 8345F401 		addl	$1, -12(%ebp)
 597              	.L30:
 598 00c7 837DF418 		cmpl	$24, -12(%ebp)
 599 00cb 768E     		jbe	.L33
 600 00cd 90       		nop
 601 00ce 8D65F8   		leal	-8(%ebp), %esp
 602 00d1 5B       		popl	%ebx
 603              		.cfi_restore 3
 604 00d2 5E       		popl	%esi
 605              		.cfi_restore 6
 606 00d3 5D       		popl	%ebp
 607              		.cfi_restore 5
 608              		.cfi_def_cfa 4, 4
GAS LISTING /tmp/ccS10dth.s 			page 14


 609 00d4 C3       		ret
 610              		.cfi_endproc
 611              	.LFE6:
 612              		.size	scroll, .-scroll
 613              		.section	.text.newline,"ax",@progbits
 614              		.globl	newline
 615              		.type	newline, @function
 616              	newline:
 617              	.LFB7:
 618              		.cfi_startproc
 619 0000 55       		pushl	%ebp
 620              		.cfi_def_cfa_offset 8
 621              		.cfi_offset 5, -8
 622 0001 89E5     		movl	%esp, %ebp
 623              		.cfi_def_cfa_register 5
 624 0003 83EC08   		subl	$8, %esp
 625 0006 C705E40F 		movl	$0, vga_col
 625      00000000 
 625      0000
 626 0010 A1E00F00 		movl	vga_row, %eax
 626      00
 627 0015 83F818   		cmpl	$24, %eax
 628 0018 740F     		je	.L35
 629 001a A1E00F00 		movl	vga_row, %eax
 629      00
 630 001f 83C001   		addl	$1, %eax
 631 0022 A3E00F00 		movl	%eax, vga_row
 631      00
 632 0027 EB05     		jmp	.L37
 633              	.L35:
 634 0029 E8FCFFFF 		call	scroll
 634      FF
 635              	.L37:
 636 002e 90       		nop
 637 002f C9       		leave
 638              		.cfi_restore 5
 639              		.cfi_def_cfa 4, 4
 640 0030 C3       		ret
 641              		.cfi_endproc
 642              	.LFE7:
 643              		.size	newline, .-newline
 644              		.section	.text.pstty_putc,"ax",@progbits
 645              		.globl	pstty_putc
 646              		.type	pstty_putc, @function
 647              	pstty_putc:
 648              	.LFB8:
 649              		.cfi_startproc
 650 0000 55       		pushl	%ebp
 651              		.cfi_def_cfa_offset 8
 652              		.cfi_offset 5, -8
 653 0001 89E5     		movl	%esp, %ebp
 654              		.cfi_def_cfa_register 5
 655 0003 53       		pushl	%ebx
 656 0004 83EC24   		subl	$36, %esp
 657              		.cfi_offset 3, -12
 658 0007 8B4508   		movl	8(%ebp), %eax
 659 000a 8845E4   		movb	%al, -28(%ebp)
GAS LISTING /tmp/ccS10dth.s 			page 15


 660 000d C645F700 		movb	$0, -9(%ebp)
 661 0011 C645F600 		movb	$0, -10(%ebp)
 662 0015 0FBE45E4 		movsbl	-28(%ebp), %eax
 663 0019 83F809   		cmpl	$9, %eax
 664 001c 7416     		je	.L40
 665 001e 83F80A   		cmpl	$10, %eax
 666 0021 7407     		je	.L41
 667 0023 83F808   		cmpl	$8, %eax
 668 0026 742A     		je	.L42
 669 0028 EB76     		jmp	.L48
 670              	.L41:
 671 002a E8FCFFFF 		call	newline
 671      FF
 672 002f E9B20000 		jmp	.L43
 672      00
 673              	.L40:
 674 0034 83EC0C   		subl	$12, %esp
 675 0037 6A20     		pushl	$32
 676 0039 E8FCFFFF 		call	pstty_putc
 676      FF
 677 003e 83C410   		addl	$16, %esp
 678 0041 A1E40F00 		movl	vga_col, %eax
 678      00
 679 0046 83E007   		andl	$7, %eax
 680 0049 85C0     		testl	%eax, %eax
 681 004b 75E7     		jne	.L40
 682 004d E9940000 		jmp	.L43
 682      00
 683              	.L42:
 684 0052 A1E40F00 		movl	vga_col, %eax
 684      00
 685 0057 85C0     		testl	%eax, %eax
 686 0059 7522     		jne	.L44
 687 005b A1E00F00 		movl	vga_row, %eax
 687      00
 688 0060 85C0     		testl	%eax, %eax
 689 0062 7419     		je	.L44
 690 0064 A1E00F00 		movl	vga_row, %eax
 690      00
 691 0069 83E801   		subl	$1, %eax
 692 006c A3E00F00 		movl	%eax, vga_row
 692      00
 693 0071 C705E40F 		movl	$79, vga_col
 693      00004F00 
 693      0000
 694 007b EB21     		jmp	.L45
 695              	.L44:
 696 007d A1E00F00 		movl	vga_row, %eax
 696      00
 697 0082 85C0     		testl	%eax, %eax
 698 0084 7509     		jne	.L46
 699 0086 A1E40F00 		movl	vga_col, %eax
 699      00
 700 008b 85C0     		testl	%eax, %eax
 701 008d 740F     		je	.L45
 702              	.L46:
 703 008f A1E40F00 		movl	vga_col, %eax
GAS LISTING /tmp/ccS10dth.s 			page 16


 703      00
 704 0094 83E801   		subl	$1, %eax
 705 0097 A3E40F00 		movl	%eax, vga_col
 705      00
 706 009c EB48     		jmp	.L43
 707              	.L45:
 708 009e EB46     		jmp	.L43
 709              	.L48:
 710 00a0 A1E00F00 		movl	vga_row, %eax
 710      00
 711 00a5 89C3     		movl	%eax, %ebx
 712 00a7 A1E40F00 		movl	vga_col, %eax
 712      00
 713 00ac 89C1     		movl	%eax, %ecx
 714 00ae A1E80F00 		movl	vga_attrib, %eax
 714      00
 715 00b3 0FBED0   		movsbl	%al, %edx
 716 00b6 0FBE45E4 		movsbl	-28(%ebp), %eax
 717 00ba 53       		pushl	%ebx
 718 00bb 51       		pushl	%ecx
 719 00bc 52       		pushl	%edx
 720 00bd 50       		pushl	%eax
 721 00be E8FCFFFF 		call	draw_char
 721      FF
 722 00c3 83C410   		addl	$16, %esp
 723 00c6 A1E40F00 		movl	vga_col, %eax
 723      00
 724 00cb 83F84F   		cmpl	$79, %eax
 725 00ce 740F     		je	.L47
 726 00d0 A1E40F00 		movl	vga_col, %eax
 726      00
 727 00d5 83C001   		addl	$1, %eax
 728 00d8 A3E40F00 		movl	%eax, vga_col
 728      00
 729 00dd EB07     		jmp	.L49
 730              	.L47:
 731 00df E8FCFFFF 		call	newline
 731      FF
 732 00e4 EB00     		jmp	.L49
 733              	.L43:
 734              	.L49:
 735 00e6 90       		nop
 736 00e7 8B5DFC   		movl	-4(%ebp), %ebx
 737 00ea C9       		leave
 738              		.cfi_restore 5
 739              		.cfi_restore 3
 740              		.cfi_def_cfa 4, 4
 741 00eb C3       		ret
 742              		.cfi_endproc
 743              	.LFE8:
 744              		.size	pstty_putc, .-pstty_putc
 745              		.section	.text.pstty_change_attr,"ax",@progbits
 746              		.globl	pstty_change_attr
 747              		.type	pstty_change_attr, @function
 748              	pstty_change_attr:
 749              	.LFB9:
 750              		.cfi_startproc
GAS LISTING /tmp/ccS10dth.s 			page 17


 751 0000 55       		pushl	%ebp
 752              		.cfi_def_cfa_offset 8
 753              		.cfi_offset 5, -8
 754 0001 89E5     		movl	%esp, %ebp
 755              		.cfi_def_cfa_register 5
 756 0003 83EC04   		subl	$4, %esp
 757 0006 8B4508   		movl	8(%ebp), %eax
 758 0009 8845FC   		movb	%al, -4(%ebp)
 759 000c 0FBE45FC 		movsbl	-4(%ebp), %eax
 760 0010 A3E80F00 		movl	%eax, vga_attrib
 760      00
 761 0015 90       		nop
 762 0016 C9       		leave
 763              		.cfi_restore 5
 764              		.cfi_def_cfa 4, 4
 765 0017 C3       		ret
 766              		.cfi_endproc
 767              	.LFE9:
 768              		.size	pstty_change_attr, .-pstty_change_attr
 769              		.section	.text.pstty_set_attr_at_off,"ax",@progbits
 770              		.globl	pstty_set_attr_at_off
 771              		.type	pstty_set_attr_at_off, @function
 772              	pstty_set_attr_at_off:
 773              	.LFB10:
 774              		.cfi_startproc
 775 0000 55       		pushl	%ebp
 776              		.cfi_def_cfa_offset 8
 777              		.cfi_offset 5, -8
 778 0001 89E5     		movl	%esp, %ebp
 779              		.cfi_def_cfa_register 5
 780 0003 56       		pushl	%esi
 781 0004 53       		pushl	%ebx
 782 0005 83EC10   		subl	$16, %esp
 783              		.cfi_offset 6, -12
 784              		.cfi_offset 3, -16
 785 0008 8B4D08   		movl	8(%ebp), %ecx
 786 000b 8B550C   		movl	12(%ebp), %edx
 787 000e 8B4510   		movl	16(%ebp), %eax
 788 0011 884DF4   		movb	%cl, -12(%ebp)
 789 0014 8855F0   		movb	%dl, -16(%ebp)
 790 0017 8845EC   		movb	%al, -20(%ebp)
 791 001a 0FBE75F0 		movsbl	-16(%ebp), %esi
 792 001e 0FBE5DF4 		movsbl	-12(%ebp), %ebx
 793 0022 0FBE4DEC 		movsbl	-20(%ebp), %ecx
 794 0026 0FBE55F0 		movsbl	-16(%ebp), %edx
 795 002a 89D0     		movl	%edx, %eax
 796 002c C1E002   		sall	$2, %eax
 797 002f 01D0     		addl	%edx, %eax
 798 0031 C1E004   		sall	$4, %eax
 799 0034 89C2     		movl	%eax, %edx
 800 0036 0FBE45F4 		movsbl	-12(%ebp), %eax
 801 003a 01D0     		addl	%edx, %eax
 802 003c 01C0     		addl	%eax, %eax
 803 003e 0FB68000 		movzbl	buf(%eax), %eax
 803      000000
 804 0045 0FBEC0   		movsbl	%al, %eax
 805 0048 56       		pushl	%esi
GAS LISTING /tmp/ccS10dth.s 			page 18


 806 0049 53       		pushl	%ebx
 807 004a 51       		pushl	%ecx
 808 004b 50       		pushl	%eax
 809 004c E8FCFFFF 		call	draw_char
 809      FF
 810 0051 83C410   		addl	$16, %esp
 811 0054 90       		nop
 812 0055 8D65F8   		leal	-8(%ebp), %esp
 813 0058 5B       		popl	%ebx
 814              		.cfi_restore 3
 815 0059 5E       		popl	%esi
 816              		.cfi_restore 6
 817 005a 5D       		popl	%ebp
 818              		.cfi_restore 5
 819              		.cfi_def_cfa 4, 4
 820 005b C3       		ret
 821              		.cfi_endproc
 822              	.LFE10:
 823              		.size	pstty_set_attr_at_off, .-pstty_set_attr_at_off
 824              		.section	.text.pstty_set_char_at_off,"ax",@progbits
 825              		.globl	pstty_set_char_at_off
 826              		.type	pstty_set_char_at_off, @function
 827              	pstty_set_char_at_off:
 828              	.LFB11:
 829              		.cfi_startproc
 830 0000 55       		pushl	%ebp
 831              		.cfi_def_cfa_offset 8
 832              		.cfi_offset 5, -8
 833 0001 89E5     		movl	%esp, %ebp
 834              		.cfi_def_cfa_register 5
 835 0003 53       		pushl	%ebx
 836 0004 83EC14   		subl	$20, %esp
 837              		.cfi_offset 3, -12
 838 0007 8B4D08   		movl	8(%ebp), %ecx
 839 000a 8B550C   		movl	12(%ebp), %edx
 840 000d 8B4510   		movl	16(%ebp), %eax
 841 0010 884DF4   		movb	%cl, -12(%ebp)
 842 0013 8855F0   		movb	%dl, -16(%ebp)
 843 0016 8845EC   		movb	%al, -20(%ebp)
 844 0019 0FBE5DF0 		movsbl	-16(%ebp), %ebx
 845 001d 0FBE4DF4 		movsbl	-12(%ebp), %ecx
 846 0021 0FBE55F0 		movsbl	-16(%ebp), %edx
 847 0025 89D0     		movl	%edx, %eax
 848 0027 C1E002   		sall	$2, %eax
 849 002a 01D0     		addl	%edx, %eax
 850 002c C1E004   		sall	$4, %eax
 851 002f 89C2     		movl	%eax, %edx
 852 0031 0FBE45F4 		movsbl	-12(%ebp), %eax
 853 0035 01D0     		addl	%edx, %eax
 854 0037 01C0     		addl	%eax, %eax
 855 0039 83C001   		addl	$1, %eax
 856 003c 0FB68000 		movzbl	buf(%eax), %eax
 856      000000
 857 0043 0FBED0   		movsbl	%al, %edx
 858 0046 0FBE45EC 		movsbl	-20(%ebp), %eax
 859 004a 53       		pushl	%ebx
 860 004b 51       		pushl	%ecx
GAS LISTING /tmp/ccS10dth.s 			page 19


 861 004c 52       		pushl	%edx
 862 004d 50       		pushl	%eax
 863 004e E8FCFFFF 		call	draw_char
 863      FF
 864 0053 83C410   		addl	$16, %esp
 865 0056 90       		nop
 866 0057 8B5DFC   		movl	-4(%ebp), %ebx
 867 005a C9       		leave
 868              		.cfi_restore 5
 869              		.cfi_restore 3
 870              		.cfi_def_cfa 4, 4
 871 005b C3       		ret
 872              		.cfi_endproc
 873              	.LFE11:
 874              		.size	pstty_set_char_at_off, .-pstty_set_char_at_off
 875              		.section	.text.pstty_get_cursor,"ax",@progbits
 876              		.globl	pstty_get_cursor
 877              		.type	pstty_get_cursor, @function
 878              	pstty_get_cursor:
 879              	.LFB12:
 880              		.cfi_startproc
 881 0000 55       		pushl	%ebp
 882              		.cfi_def_cfa_offset 8
 883              		.cfi_offset 5, -8
 884 0001 89E5     		movl	%esp, %ebp
 885              		.cfi_def_cfa_register 5
 886 0003 83EC18   		subl	$24, %esp
 887 0006 A1E40F00 		movl	vga_col, %eax
 887      00
 888 000b 8845F6   		movb	%al, -10(%ebp)
 889 000e A1E00F00 		movl	vga_row, %eax
 889      00
 890 0013 8845F7   		movb	%al, -9(%ebp)
 891 0016 A1000000 		movl	pstty_fd, %eax
 891      00
 892 001b 83EC04   		subl	$4, %esp
 893 001e 8D55F6   		leal	-10(%ebp), %edx
 894 0021 52       		pushl	%edx
 895 0022 6A06     		pushl	$6
 896 0024 50       		pushl	%eax
 897 0025 E8FCFFFF 		call	ioctl
 897      FF
 898 002a 83C410   		addl	$16, %esp
 899 002d 90       		nop
 900 002e C9       		leave
 901              		.cfi_restore 5
 902              		.cfi_def_cfa 4, 4
 903 002f C3       		ret
 904              		.cfi_endproc
 905              	.LFE12:
 906              		.size	pstty_get_cursor, .-pstty_get_cursor
 907              		.section	.text.pstty_set_cursor,"ax",@progbits
 908              		.globl	pstty_set_cursor
 909              		.type	pstty_set_cursor, @function
 910              	pstty_set_cursor:
 911              	.LFB13:
 912              		.cfi_startproc
GAS LISTING /tmp/ccS10dth.s 			page 20


 913 0000 55       		pushl	%ebp
 914              		.cfi_def_cfa_offset 8
 915              		.cfi_offset 5, -8
 916 0001 89E5     		movl	%esp, %ebp
 917              		.cfi_def_cfa_register 5
 918 0003 83EC08   		subl	$8, %esp
 919 0006 8B5508   		movl	8(%ebp), %edx
 920 0009 8B450C   		movl	12(%ebp), %eax
 921 000c 8855FC   		movb	%dl, -4(%ebp)
 922 000f 8845F8   		movb	%al, -8(%ebp)
 923 0012 0FBE45F8 		movsbl	-8(%ebp), %eax
 924 0016 A3E00F00 		movl	%eax, vga_row
 924      00
 925 001b 0FBE45FC 		movsbl	-4(%ebp), %eax
 926 001f A3E40F00 		movl	%eax, vga_col
 926      00
 927 0024 90       		nop
 928 0025 C9       		leave
 929              		.cfi_restore 5
 930              		.cfi_def_cfa 4, 4
 931 0026 C3       		ret
 932              		.cfi_endproc
 933              	.LFE13:
 934              		.size	pstty_set_cursor, .-pstty_set_cursor
 935              		.globl	k
 936              		.data
 937              		.align 4
 938              		.type	k, @object
 939              		.size	k, 4
 940              	k:
 941 1040 00000000 		.zero	4
 942              		.section	.text.pstty_event,"ax",@progbits
 943              		.globl	pstty_event
 944              		.type	pstty_event, @function
 945              	pstty_event:
 946              	.LFB14:
 947              		.cfi_startproc
 948 0000 55       		pushl	%ebp
 949              		.cfi_def_cfa_offset 8
 950              		.cfi_offset 5, -8
 951 0001 89E5     		movl	%esp, %ebp
 952              		.cfi_def_cfa_register 5
 953 0003 56       		pushl	%esi
 954 0004 53       		pushl	%ebx
 955 0005 83EC10   		subl	$16, %esp
 956              		.cfi_offset 6, -12
 957              		.cfi_offset 3, -16
 958 0008 8B4508   		movl	8(%ebp), %eax
 959 000b 0FB64001 		movzbl	1(%eax), %eax
 960 000f 8845F7   		movb	%al, -9(%ebp)
 961 0012 8B4508   		movl	8(%ebp), %eax
 962 0015 0FB64002 		movzbl	2(%eax), %eax
 963 0019 8845F6   		movb	%al, -10(%ebp)
 964 001c 8B4508   		movl	8(%ebp), %eax
 965 001f 0FB64003 		movzbl	3(%eax), %eax
 966 0023 8845F5   		movb	%al, -11(%ebp)
 967 0026 8B4508   		movl	8(%ebp), %eax
GAS LISTING /tmp/ccS10dth.s 			page 21


 968 0029 0FB64004 		movzbl	4(%eax), %eax
 969 002d 8845F4   		movb	%al, -12(%ebp)
 970 0030 8B4508   		movl	8(%ebp), %eax
 971 0033 0FB64005 		movzbl	5(%eax), %eax
 972 0037 8845F3   		movb	%al, -13(%ebp)
 973 003a 8B4508   		movl	8(%ebp), %eax
 974 003d 0FB600   		movzbl	(%eax), %eax
 975 0040 3C11     		cmpb	$17, %al
 976 0042 757C     		jne	.L56
 977 0044 8B150000 		movl	y2, %edx
 977      0000
 978 004a A1000000 		movl	y1, %eax
 978      00
 979 004f 29C2     		subl	%eax, %edx
 980 0051 89D0     		movl	%edx, %eax
 981 0053 89C6     		movl	%eax, %esi
 982 0055 8B150000 		movl	x2, %edx
 982      0000
 983 005b A1000000 		movl	x1, %eax
 983      00
 984 0060 29C2     		subl	%eax, %edx
 985 0062 89D0     		movl	%edx, %eax
 986 0064 89C3     		movl	%eax, %ebx
 987 0066 A1000000 		movl	y1, %eax
 987      00
 988 006b 89C1     		movl	%eax, %ecx
 989 006d A1000000 		movl	x1, %eax
 989      00
 990 0072 89C2     		movl	%eax, %edx
 991 0074 A1000000 		movl	win, %eax
 991      00
 992 0079 83EC0C   		subl	$12, %esp
 993 007c 56       		pushl	%esi
 994 007d 53       		pushl	%ebx
 995 007e 51       		pushl	%ecx
 996 007f 52       		pushl	%edx
 997 0080 50       		pushl	%eax
 998 0081 E8FCFFFF 		call	window_flush
 998      FF
 999 0086 83C420   		addl	$32, %esp
 1000 0089 C7050000 		movl	$-1, y2
 1000      0000FFFF 
 1000      FFFF
 1001 0093 A1000000 		movl	y2, %eax
 1001      00
 1002 0098 A3000000 		movl	%eax, y1
 1002      00
 1003 009d A1000000 		movl	y1, %eax
 1003      00
 1004 00a2 A3000000 		movl	%eax, x2
 1004      00
 1005 00a7 A1000000 		movl	x2, %eax
 1005      00
 1006 00ac A3000000 		movl	%eax, x1
 1006      00
 1007 00b1 C7050000 		movl	$0, scheduled
 1007      00000000 
GAS LISTING /tmp/ccS10dth.s 			page 22


 1007      0000
 1008 00bb E9910000 		jmp	.L55
 1008      00
 1009              	.L56:
 1010 00c0 0FBE45F7 		movsbl	-9(%ebp), %eax
 1011 00c4 83F805   		cmpl	$5, %eax
 1012 00c7 0F878300 		ja	.L66
 1012      0000
 1013 00cd 8B048544 		movl	.L60(,%eax,4), %eax
 1013      000000
 1014 00d4 FFE0     		jmp	*%eax
 1015              		.section	.rodata
 1016 0041 000000   		.align 4
 1017              		.align 4
 1018              	.L60:
 1019 0044 D6000000 		.long	.L59
 1020 0048 E8000000 		.long	.L61
 1021 004c FA000000 		.long	.L62
 1022 0050 16010000 		.long	.L63
 1023 0054 32010000 		.long	.L64
 1024 0058 49010000 		.long	.L65
 1025              		.section	.text.pstty_event
 1026              	.L59:
 1027 00d6 0FBE45F6 		movsbl	-10(%ebp), %eax
 1028 00da 83EC0C   		subl	$12, %esp
 1029 00dd 50       		pushl	%eax
 1030 00de E8FCFFFF 		call	pstty_putc
 1030      FF
 1031 00e3 83C410   		addl	$16, %esp
 1032 00e6 EB69     		jmp	.L55
 1033              	.L61:
 1034 00e8 0FBE45F5 		movsbl	-11(%ebp), %eax
 1035 00ec 83EC0C   		subl	$12, %esp
 1036 00ef 50       		pushl	%eax
 1037 00f0 E8FCFFFF 		call	pstty_change_attr
 1037      FF
 1038 00f5 83C410   		addl	$16, %esp
 1039 00f8 EB57     		jmp	.L55
 1040              	.L62:
 1041 00fa 0FBE4DF5 		movsbl	-11(%ebp), %ecx
 1042 00fe 0FBE55F3 		movsbl	-13(%ebp), %edx
 1043 0102 0FBE45F4 		movsbl	-12(%ebp), %eax
 1044 0106 83EC04   		subl	$4, %esp
 1045 0109 51       		pushl	%ecx
 1046 010a 52       		pushl	%edx
 1047 010b 50       		pushl	%eax
 1048 010c E8FCFFFF 		call	pstty_set_attr_at_off
 1048      FF
 1049 0111 83C410   		addl	$16, %esp
 1050 0114 EB3B     		jmp	.L55
 1051              	.L63:
 1052 0116 0FBE4DF6 		movsbl	-10(%ebp), %ecx
 1053 011a 0FBE55F3 		movsbl	-13(%ebp), %edx
 1054 011e 0FBE45F4 		movsbl	-12(%ebp), %eax
 1055 0122 83EC04   		subl	$4, %esp
 1056 0125 51       		pushl	%ecx
 1057 0126 52       		pushl	%edx
GAS LISTING /tmp/ccS10dth.s 			page 23


 1058 0127 50       		pushl	%eax
 1059 0128 E8FCFFFF 		call	pstty_set_char_at_off
 1059      FF
 1060 012d 83C410   		addl	$16, %esp
 1061 0130 EB1F     		jmp	.L55
 1062              	.L64:
 1063 0132 0FBE55F3 		movsbl	-13(%ebp), %edx
 1064 0136 0FBE45F4 		movsbl	-12(%ebp), %eax
 1065 013a 83EC08   		subl	$8, %esp
 1066 013d 52       		pushl	%edx
 1067 013e 50       		pushl	%eax
 1068 013f E8FCFFFF 		call	pstty_set_cursor
 1068      FF
 1069 0144 83C410   		addl	$16, %esp
 1070 0147 EB08     		jmp	.L55
 1071              	.L65:
 1072 0149 E8FCFFFF 		call	pstty_get_cursor
 1072      FF
 1073 014e EB01     		jmp	.L55
 1074              	.L66:
 1075 0150 90       		nop
 1076              	.L55:
 1077 0151 8D65F8   		leal	-8(%ebp), %esp
 1078 0154 5B       		popl	%ebx
 1079              		.cfi_restore 3
 1080 0155 5E       		popl	%esi
 1081              		.cfi_restore 6
 1082 0156 5D       		popl	%ebp
 1083              		.cfi_restore 5
 1084              		.cfi_def_cfa 4, 4
 1085 0157 C3       		ret
 1086              		.cfi_endproc
 1087              	.LFE14:
 1088              		.size	pstty_event, .-pstty_event
 1089              		.section	.text.pstty_press,"ax",@progbits
 1090              		.globl	pstty_press
 1091              		.type	pstty_press, @function
 1092              	pstty_press:
 1093              	.LFB15:
 1094              		.cfi_startproc
 1095 0000 55       		pushl	%ebp
 1096              		.cfi_def_cfa_offset 8
 1097              		.cfi_offset 5, -8
 1098 0001 89E5     		movl	%esp, %ebp
 1099              		.cfi_def_cfa_register 5
 1100 0003 83EC18   		subl	$24, %esp
 1101 0006 8B4508   		movl	8(%ebp), %eax
 1102 0009 8845F4   		movb	%al, -12(%ebp)
 1103 000c A1000000 		movl	pstty_fd, %eax
 1103      00
 1104 0011 83EC04   		subl	$4, %esp
 1105 0014 8D55F4   		leal	-12(%ebp), %edx
 1106 0017 52       		pushl	%edx
 1107 0018 6A00     		pushl	$0
 1108 001a 50       		pushl	%eax
 1109 001b E8FCFFFF 		call	ioctl
 1109      FF
GAS LISTING /tmp/ccS10dth.s 			page 24


 1110 0020 83C410   		addl	$16, %esp
 1111 0023 90       		nop
 1112 0024 C9       		leave
 1113              		.cfi_restore 5
 1114              		.cfi_def_cfa 4, 4
 1115 0025 C3       		ret
 1116              		.cfi_endproc
 1117              	.LFE15:
 1118              		.size	pstty_press, .-pstty_press
 1119              		.section	.rodata
 1120              		.align 4
 1121              	.LC6:
 1122 005c 2F757372 		.string	"/usr/share/icons/qonsole16.png"
 1122      2F736861 
 1122      72652F69 
 1122      636F6E73 
 1122      2F716F6E 
 1123              	.LC7:
 1124 007b 516F6E73 		.string	"Qonsole"
 1124      6F6C6500 
 1125              	.LC8:
 1126 0083 2F62696E 		.string	"/bin/rash"
 1126      2F726173 
 1126      6800
 1127              		.section	.text.main,"ax",@progbits
 1128              		.globl	main
 1129              		.type	main, @function
 1130              	main:
 1131              	.LFB16:
 1132              		.cfi_startproc
 1133 0000 8D4C2404 		leal	4(%esp), %ecx
 1134              		.cfi_def_cfa 1, 0
 1135 0004 83E4F0   		andl	$-16, %esp
 1136 0007 FF71FC   		pushl	-4(%ecx)
 1137 000a 55       		pushl	%ebp
 1138              		.cfi_escape 0x10,0x5,0x2,0x75,0
 1139 000b 89E5     		movl	%esp, %ebp
 1140 000d 51       		pushl	%ecx
 1141              		.cfi_escape 0xf,0x3,0x75,0x7c,0x6
 1142 000e 83EC04   		subl	$4, %esp
 1143 0011 E8FCFFFF 		call	font_init
 1143      FF
 1144 0016 E8FCFFFF 		call	timer_init
 1144      FF
 1145 001b 8B150000 		movl	font_height, %edx
 1145      0000
 1146 0021 89D0     		movl	%edx, %eax
 1147 0023 C1E002   		sall	$2, %eax
 1148 0026 01D0     		addl	%edx, %eax
 1149 0028 8D148500 		leal	0(,%eax,4), %edx
 1149      000000
 1150 002f 8D0C10   		leal	(%eax,%edx), %ecx
 1151 0032 8B150000 		movl	font_width, %edx
 1151      0000
 1152 0038 89D0     		movl	%edx, %eax
 1153 003a C1E002   		sall	$2, %eax
 1154 003d 01D0     		addl	%edx, %eax
GAS LISTING /tmp/ccS10dth.s 			page 25


 1155 003f C1E004   		sall	$4, %eax
 1156 0042 83EC04   		subl	$4, %esp
 1157 0045 685C0000 		pushl	$.LC6
 1157      00
 1158 004a 68000000 		pushl	$-16777216
 1158      FF
 1159 004f 6AFF     		pushl	$-1
 1160 0051 6AFF     		pushl	$-1
 1161 0053 51       		pushl	%ecx
 1162 0054 50       		pushl	%eax
 1163 0055 687B0000 		pushl	$.LC7
 1163      00
 1164 005a E8FCFFFF 		call	window_alloc
 1164      FF
 1165 005f 83C420   		addl	$32, %esp
 1166 0062 A3000000 		movl	%eax, win
 1166      00
 1167 0067 A1000000 		movl	win, %eax
 1167      00
 1168 006c C780AC08 		movl	$pstty_press, 2220(%eax)
 1168      00000000 
 1168      0000
 1169 0076 E8FCFFFF 		call	pstty_init
 1169      FF
 1170 007b 83EC0C   		subl	$12, %esp
 1171 007e 68830000 		pushl	$.LC8
 1171      00
 1172 0083 E8FCFFFF 		call	exec_shell
 1172      FF
 1173 0088 83C410   		addl	$16, %esp
 1174 008b 83EC0C   		subl	$12, %esp
 1175 008e 68000000 		pushl	$pstty_event
 1175      00
 1176 0093 E8FCFFFF 		call	set_receiver
 1176      FF
 1177 0098 83C410   		addl	$16, %esp
 1178 009b E8FCFFFF 		call	gui_loop
 1178      FF
 1179 00a0 B8000000 		movl	$0, %eax
 1179      00
 1180 00a5 8B4DFC   		movl	-4(%ebp), %ecx
 1181              		.cfi_def_cfa 1, 0
 1182 00a8 C9       		leave
 1183              		.cfi_restore 5
 1184 00a9 8D61FC   		leal	-4(%ecx), %esp
 1185              		.cfi_def_cfa 4, 4
 1186 00ac C3       		ret
 1187              		.cfi_endproc
 1188              	.LFE16:
 1189              		.size	main, .-main
 1190              		.ident	"GCC: (GNU) 5.1.0"
 1191              		.section	.note.GNU-stack,"",@progbits
GAS LISTING /tmp/ccS10dth.s 			page 26


DEFINED SYMBOLS
                            *ABS*:0000000000000000 main.c
                            *COM*:0000000000000004 timer_fd
     /tmp/ccS10dth.s:8      .data:0000000000000000 scheduled
                            *COM*:0000000000000004 pstty_fd
     /tmp/ccS10dth.s:15     .data:0000000000000004 pstty_file
                            *COM*:0000000000000004 win
     /tmp/ccS10dth.s:20     .bss:0000000000000000 font
                            *COM*:0000000000000004 font_width
                            *COM*:0000000000000004 font_height
     /tmp/ccS10dth.s:27     .data:0000000000000018 x1
     /tmp/ccS10dth.s:33     .data:000000000000001c y1
     /tmp/ccS10dth.s:39     .data:0000000000000020 x2
     /tmp/ccS10dth.s:45     .data:0000000000000024 y2
     /tmp/ccS10dth.s:57     .text.font_init:0000000000000000 font_init
     /tmp/ccS10dth.s:120    .text.pstty_init:0000000000000000 pstty_init
     /tmp/ccS10dth.s:192    .text.timer_init:0000000000000000 timer_init
     /tmp/ccS10dth.s:221    .text.exec_shell:0000000000000000 exec_shell
     /tmp/ccS10dth.s:284    .data:0000000000000040 buf
     /tmp/ccS10dth.s:289    .data:0000000000000fe0 vga_row
     /tmp/ccS10dth.s:294    .data:0000000000000fe4 vga_col
     /tmp/ccS10dth.s:299    .data:0000000000000fe8 vga_attrib
     /tmp/ccS10dth.s:304    .data:0000000000001000 color_palette
     /tmp/ccS10dth.s:324    .text.draw_char:0000000000000000 draw_char
     /tmp/ccS10dth.s:520    .text.scroll:0000000000000000 scroll
     /tmp/ccS10dth.s:616    .text.newline:0000000000000000 newline
     /tmp/ccS10dth.s:647    .text.pstty_putc:0000000000000000 pstty_putc
     /tmp/ccS10dth.s:748    .text.pstty_change_attr:0000000000000000 pstty_change_attr
     /tmp/ccS10dth.s:772    .text.pstty_set_attr_at_off:0000000000000000 pstty_set_attr_at_off
     /tmp/ccS10dth.s:827    .text.pstty_set_char_at_off:0000000000000000 pstty_set_char_at_off
     /tmp/ccS10dth.s:878    .text.pstty_get_cursor:0000000000000000 pstty_get_cursor
     /tmp/ccS10dth.s:910    .text.pstty_set_cursor:0000000000000000 pstty_set_cursor
     /tmp/ccS10dth.s:940    .data:0000000000001040 k
     /tmp/ccS10dth.s:945    .text.pstty_event:0000000000000000 pstty_event
     /tmp/ccS10dth.s:1092   .text.pstty_press:0000000000000000 pstty_press
     /tmp/ccS10dth.s:1130   .text.main:0000000000000000 main

UNDEFINED SYMBOLS
fopen
fscanf
fclose
open
ioctl
close
strlen
getpid
itoa
mknod
fork
chdir
execve
pixbuf_set_pixel
window_flush
window_alloc
set_receiver
gui_loop
